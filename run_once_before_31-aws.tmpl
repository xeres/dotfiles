{{- if (eq .chezmoi.os "linux") -}}
#!/bin/bash
# -*- shellscript -*-

set -e

sudo apt-get install -y jq

curl -s "https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip" -o "awscliv2.zip" && \
    unzip -q awscliv2.zip && \
    ./aws/install -i ~/.local/share/aws-cli -b ~/.local/bin --update && \
    rm -rf ./aws awscliv2.zip

curl -s "https://s3.amazonaws.com/session-manager-downloads/plugin/latest/ubuntu_64bit/session-manager-plugin.deb" -o "session-manager-plugin.deb" && \
    dpkg-deb -x session-manager-plugin.deb session-manager-plugin && \
    cp session-manager-plugin/usr/local/sessionmanagerplugin/bin/session-manager-plugin ~/.local/bin && \
    rm -rf session-manager-plugin.deb session-manager-plugin

export PIPX_HOME="$HOME/.local/share/pipx"
export PIPX_DEFAULT_PYTHON="$PYENV_ROOT/versions/3.8.8/bin/python"
pipx install -f git-remote-codecommit
pipx install -f aws-sam-cli
pipx install -f cfn-lint
{{ end }}
